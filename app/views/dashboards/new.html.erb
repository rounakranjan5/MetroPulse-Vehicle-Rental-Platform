<div class="container my-5" style="max-width: 900px;">
    <div class="row shadow rounded" style="min-height: 300px; background: #ffffff;">

        <div class="col-md-4 bg-primary text-white rounded-start d-flex flex-column p-4">
            <h3 class="mb-4" style="font-weight: 700;"><%= t('dashboard.dashboard_menu') %></h3>
            <nav class="nav flex-column">

                <% if Current.user.role=='Provider' %>



                <%= link_to t('dashboard.my_rental_stations'), dashboard_rental_stations_path ,class: "nav-link text-white py-2 px-3 rounded mb-2 hover-bg-light" ,style: "background: #0d6efd;"  %>


                <%= link_to t('dashboard.my_vehicles'), dashboard_my_vehicles_path , class: "nav-link text-white py-2 px-3 rounded mb-2 hover-bg-light" %>




                <% end %>

                <div class=" d-flex hover-bg-light rounded mb-2">
                    <%= link_to t('dashboard.all_bookings'), all_bookings_path, class: "nav-link text-white py-2 px-3  " %>

                    <% if Current.user && Booking.where(provider_id: Current.user.id, status: "pending").any? %>
                    <i class="fa-solid fa-circle fa-2xs" style="color: #FF0000;margin-top:0.75rem;margin-left:-0.9rem;"></i>

                    <% elsif Current.user && Booking.where(customer_id: Current.user.id, status: "pending").any? %>
                    <i class="fa-solid fa-circle fa-2xs" style="color: #FF0000;margin-top:0.75rem;margin-left:-0.9rem;"></i>
                  
                   <% elsif Current.user && Booking.where(customer_id: Current.user.id, status: "accepted").any? %>
                    <i class="fa-solid fa-circle fa-2xs" style="color: #FF0000;margin-top:0.75rem;margin-left:-0.9rem;"></i>

                    <% end %>

                </div>



                <%= link_to t('dashboard.rental_history') , rental_history_path ,class: "nav-link text-white py-2 px-3 rounded mb-2 hover-bg-light" , style: "background: #0d6efd;" %>

                <%= link_to t('dashboard.change_password'),edit_password_path, class:"nav-link text-white py-2 px-3 rounded mb-2 hover-bg-light" %>
            </nav>
        </div>

        <div class="col-md-8 p-5">
            <h1 class="mb-4" style="color: #343a40; font-weight: 700;"><%= t('dashboard.welcome_back') %> <span style="color:#0d6efd;"><%= Current.user.username if Current.user %> üëã</span></h1>
            <p class="lead" style="color: #6c757d;">
                <%= t('dashboard.stats') %>
            </p>

            <div class="row mt-4">
                <div class="col-sm-6 mb-3">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title"><%= t('dashboard.total_bookings') %></h5>
                            <p class="display-5 text-primary">
                                <% if @completed_rentals.any? %>
                                <%= @completed_rentals.count %>
                                <%else%>
                                0
                                <%end%>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 mb-3">
                    <div class="card shadow-sm border-0">
                        <div class="card-body text-center">
                            <h5 class="card-title"><%= t('dashboard.upcoming_bookings') %></h5>
                            <p class="display-5 text-success">
                                <% if @upcoming_bookings.any? %>
                                <%= @upcoming_bookings.count %>
                                <% else %>
                                0
                                <% end %>
                            </p>
                        </div>
                    </div>
                </div>
              
                 

              <% if Current.user.role=='Provider' %>

                    <div class="col-sm-6 mb-3">
                        <div class="card shadow-sm border-0">
                            <div class="card-body text-center">
                                <h5 class="card-title"><%= t('dashboard.your_rating') %></h5>
                                <p class="display-5 text-success">
                                <% if @completed_rentals.count== 0 %>
                                0‚≠ê
                                <% elsif @average_rating.nil? %>
                                0‚≠ê
                                <%else%>
                                <%= @average_rating%>‚≠ê
                                <%end%>
                                </p>
                            </div>
                        </div>
                    </div>


                <div class="col-sm-6 mb-3">
                        <div class="card shadow-sm border-0">
                            <div class="card-body text-center">
                                <h5 class="card-title"><%= t('dashboard.total_earnings') %></h5>
                                <p class="display-5 text-success">
                                <% if @completed_rentals.any? %>
                                ‚Çπ<%= @completed_rentals.sum(:price) %>
                                <%else%>
                                ‚Çπ0
                                <%end%>
                                </p>
                            </div>
                        </div>
                    </div>
              <%end%>

            </div>

        </div>

    </div>
</div>

<style>
    .hover-bg-light:hover {
        background-color: rgba(255, 255, 255, 0.25) !important;
        transition: background-color 0.3s ease;
    }
</style>
